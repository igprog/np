/*!
app.js
(c) 2018 IG PROG, www.igprog.hr
*/
angular.module("app", ["ngMaterial"]).config(["$httpProvider", function (e) { e.defaults.headers.get || (e.defaults.headers.get = {}), e.defaults.headers.get["If-Modified-Since"] = "Mon, 26 Jul 1997 05:00:00 GMT", e.defaults.headers.get["Cache-Control"] = "no-cache", e.defaults.headers.get.Pragma = "no-cache" }]).controller("appCtrl", ["$scope", "$http", "$rootScope", function (e, n, a) { n.get("./config/config.json").then(function (e) { a.config = e.data }); var s = new Date; e.year = s.getFullYear(), e.sendicon = "fa fa-angle-double-right", e.sendicontitle = "Next", e.hashId = function (e) { window.location.hash = e }, e.href = function (e) { window.open(e, "_blank") }, e.today = new Date, e.send = function (s) { e.sendicon = "fa fa-spinner fa-spin", e.sendicontitle = "Sending", n({ url: a.config.backend + "Mail.asmx/Send", method: "POST", data: { name: s.name, email: s.email, phone: s.phone, address: s.address, type: s.type, message: s.message } }).then(function (n) { e.sendicon = "fa fa-check", e.sendicontitle = "Sent" }, function (n) { e.sendicon = "fa fa-exclamation-triangle", e.sendicontitle = "Error", alert(n.data.d) }) } }]).controller("webAppCtrl", ["$scope", "$http", "$rootScope", function (e, n, a) { a.application = "Nutrition Plan", a.version = "STANDARD" }]).controller("signupCtrl", ["$scope", "$http", "$rootScope", function (e, n, a) { e.accept = !1, e.msg = { title: null, css: null, icon: null }, e.hidebutton = !1, e.signupok = !1; var s = function () { n({ url: a.config.backend + "Users.asmx/Init", method: "POST", data: "" }).then(function (n) { e.user = JSON.parse(n.data.d), e.passwordConfirm = "", e.emailConfirm = "" }, function (e) { alert(e.data.d) }) }; null == a.config ? n.get("./config/config.json").then(function (e) { a.config = e.data, s() }) : s(), e.signup = function (s) { return e.msg = { title: null, css: null, icon: null }, s.userName = s.email, "" == s.firstName || "" == s.lastName || "" == s.email || "" == s.password || "" == e.passwordConfirm || "" == e.emailConfirm ? (e.msg.title = "All fields are required", e.msg.css = "danger", e.msg.icon = "exclamation", !1) : s.email != e.emailConfirm ? (e.msg.title = "Email addresses must be equal", e.msg.css = "danger", e.msg.icon = "exclamation", !1) : s.password != e.passwordConfirm ? (e.msg.title = "The passwords must be equal", e.msg.css = "danger", e.msg.icon = "exclamation", !1) : 0 == e.accept ? (e.msg.title = "You must accept the terms of use", e.msg.css = "danger", e.msg.icon = "exclamation", !1) : (e.hidebutton = !0, e.signupok = !1, void n({ url: a.config.backend + "Users.asmx/Signup", method: "POST", data: { x: s, lang: a.config.language } }).then(function (n) { "the email address you have entered is already registered" == n.data.d && (e.msg.title = "The email address you have entered is already registered", e.msg.css = "danger", e.msg.icon = "exclamation", e.hidebutton = !1, e.signupok = !1), "registration completed successfully" == n.data.d && (e.msg.title = "Registration completed successfully", e.msg.css = "success", e.msg.icon = "check", e.hidebutton = !0, e.signupok = !0) }, function (n) { alert(n.data.d), e.hidebutton = !1, e.signupok = !1 })) } }]).controller("orderCtrl", ["$scope", "$http", "$rootScope", function (e, n, a) { e.application = a.application, e.version = a.version, e.userType = 1, e.showAlert = !1, e.sendicon = "fa fa-angle-double-right", e.sendicontitle = "Dalje", e.showUserDetails = !1, e.showErrorAlert = !1, e.showPaymentDetails = !1; var s = function () { n({ url: a.config.backend + "Orders.asmx/Init", method: "POST", data: "" }).then(function (n) { e.user = JSON.parse(n.data.d), e.user.application = e.application, e.user.version = e.version, e.user.licence = 1, e.user.licenceNumber = 1, e.user.userType = e.userType, e.calculatePrice() }, function (e) { alert(e.data.d) }) }; null == a.config ? n.get("./config/config.json").then(function (e) { a.config = e.data, s() }) : s(), e.changeUserType = function (n) { e.userType = n }, e.calculatePrice = function () { var n, s = 0; 0 == e.user.userType && (s = 550, e.user.version = "START"), 1 == e.user.userType && (s = 950, e.user.version = "STANDARD"), 2 == e.user.userType && (s = 1850, e.user.version = "PREMIUM"), e.user.licence > 1 && (s = s * e.user.licence - s * e.user.licence * (e.user.licence / 10)), e.user.licenceNumber = 1, n = e.user.licenceNumber > 1 ? s * e.user.licenceNumber - s * e.user.licenceNumber * .1 : s, e.user.price = n, e.user.priceEur = n / a.config.eur }, e.order = function (n, a) { s(), window.location.hash = "order", e.user.application = n, e.user.version = a, e.calculatePrice() }, e.setApplication = function (n) { e.user.application = n, e.calculatePrice() }, e.sendOrder = function (s) { return e.showErrorAlert = !1, "" == s.email || "" == s.firstName || "" == s.lastName || "" == s.address || "" == s.postalCode || "" == s.city || "" == s.country ? (e.showErrorAlert = !0, e.errorMessage = "All fields are required", !1) : 1 != e.userType || "" != s.companyName && "" != s.pin ? (e.sendicon = "fa fa-spinner fa-spin", e.sendicontitle = "Sending", e.isSendButtonDisabled = !0, void n({ url: a.config.backend + "Orders.asmx/SendOrder", method: "POST", data: { x: s, lang: a.config.language } }).then(function (n) { e.showAlert = !0, e.showPaymentDetails = !0, window.location.hash = "orderform" }, function (n) { e.showAlert = !1, e.showPaymentDetails = !1, e.sendicon = "fa fa-paper-plane-o", e.sendicontitle = "Send", alert(n.data.d) })) : (e.showErrorAlert = !0, e.errorMessage = "All fields are required", !1) }, e.login = function (s, o) { n({ url: a.config.backend + "Users.asmx/Login", method: "POST", data: { userName: s, password: o } }).then(function (n) { var a = JSON.parse(n.data.d); a.userName == s ? (e.user.firstName = a.firstName, e.user.lastName = a.lastName, e.user.companyName = a.companyName, e.user.address = a.address, e.user.postalCode = a.postalCode, e.user.city = a.city, e.user.country = a.country, e.user.pin = a.pin, e.user.email = a.email, e.showUserDetails = !0, e.showErrorAlert = !1) : (e.showErrorAlert = !0, e.errorMessage = "Error login") }, function (n) { e.errorLogin = !0, e.showErrorAlert = !0, e.errorMessage = "Error login", e.showUserDetails = !1 }) }, e.registration = function () { window.location.hash = "registration" }, e.gotoForm = function () { e.showUserDetails = !0 }, e.forgotPassword = function (s) { e.showErrorAlert = !1, e.showSuccessAlert = !1, null == s || "" == s ? (e.showErrorAlert = !0, e.errorMessage = "Enter E-mail") : n({ url: a.config.backend + "Users.asmx/ForgotPassword", method: "POST", data: { email: s, lang: a.config.language } }).then(function (n) { e.showSuccessAlert = !0, e.successMessage = JSON.parse(n.data.d) }, function (n) { e.showErrorAlert = !0, e.errorMessage = JSON.parse(n.data.d) }) } }]).controller("contactCtrl", ["$scope", "$http", "$rootScope", function (e, n, a) { e.showAlert = !1, e.sendicon = "fa fa-paper-plane-o", e.sendicontitle = "Send", e.d = { name: "", email: "", message: "" }, e.send = function (s) { null == a.config.backend && a.getConfig(), e.isSendButtonDisabled = !0, e.sendicon = "fa fa-spinner fa-spin", e.sendicontitle = "Sending", n({ url: a.config.backend + "Mail.asmx/Send", method: "POST", data: { name: s.name, email: s.email, messageSubject: "nutrition Plan - Inquiry", message: s.message, lang: a.config.language } }).then(function (n) { e.showAlert = !0, e.sendicon = "fa fa-paper-plane-o", e.sendicontitle = "Send", window.location.hash = "contact" }, function (n) { e.showAlert = !1, e.sendicon = "fa fa-paper-plane-o", e.sendicontitle = "Send", alert(n.data.d) }) } }]);