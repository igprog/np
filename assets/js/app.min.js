/*!
app.js
(c) 2018 IG PROG, www.igprog.hr
*/
angular.module("app", ["ngMaterial"]).config(["$httpProvider", function (e) { e.defaults.headers.get || (e.defaults.headers.get = {}), e.defaults.headers.get["If-Modified-Since"] = "Mon, 26 Jul 1997 05:00:00 GMT", e.defaults.headers.get["Cache-Control"] = "no-cache", e.defaults.headers.get.Pragma = "no-cache" }]).controller("appCtrl", ["$scope", "$http", "$rootScope", function (e, n, s) { n.get("./config/config.json").then(function (e) { s.config = e.data }); var a = new Date; e.year = a.getFullYear(), e.sendicon = "fa fa-angle-double-right", e.sendicontitle = "Next", e.hashId = function (e) { window.location.hash = e }, e.href = function (e) { window.open(e, "_blank") }, e.today = new Date, e.send = function (a) { e.sendicon = "fa fa-spinner fa-spin", e.sendicontitle = "Sending", n({ url: s.config.backend + "Mail.asmx/Send", method: "POST", data: { name: a.name, email: a.email, phone: a.phone, address: a.address, type: a.type, message: a.message } }).then(function (n) { e.sendicon = "fa fa-check", e.sendicontitle = "Sent" }, function (n) { e.sendicon = "fa fa-exclamation-triangle", e.sendicontitle = "Error", alert(n.data.d) }) } }]).controller("webAppCtrl", ["$scope", "$http", "$rootScope", function (e, n, s) { s.application = "Nutrition Plan", s.version = "STANDARD" }]).controller("signupCtrl", ["$scope", "$http", "$rootScope", function (e, n, s) { e.accept = !1, e.msg = { title: null, css: null, icon: null }, e.hidebutton = !1, e.signupok = !1; var a = function () { n({ url: s.config.backend + "Users.asmx/Init", method: "POST", data: "" }).then(function (n) { e.user = JSON.parse(n.data.d), e.passwordConfirm = "", e.emailConfirm = "" }, function (e) { alert(e.data.d) }) }; null == s.config ? n.get("./config/config.json").then(function (e) { s.config = e.data, a() }) : a(), e.signup = function (a) { return e.msg = { title: null, css: null, icon: null }, a.userName = a.email, "" == a.firstName || "" == a.lastName || "" == a.email || "" == a.password || "" == e.passwordConfirm || "" == e.emailConfirm ? (e.msg.title = "All fields are required", e.msg.css = "danger", e.msg.icon = "exclamation", !1) : a.email != e.emailConfirm ? (e.msg.title = "Email addresses must be equal", e.msg.css = "danger", e.msg.icon = "exclamation", !1) : a.password != e.passwordConfirm ? (e.msg.title = "The passwords must be equal", e.msg.css = "danger", e.msg.icon = "exclamation", !1) : 0 == e.accept ? (e.msg.title = "You must accept the terms of use", e.msg.css = "danger", e.msg.icon = "exclamation", !1) : (e.hidebutton = !0, e.signupok = !1, void n({ url: s.config.backend + "Users.asmx/Signup", method: "POST", data: { x: a, lang: s.config.language } }).then(function (n) { "the email address you have entered is already registered" == n.data.d && (e.msg.title = "The email address you have entered is already registered", e.msg.css = "danger", e.msg.icon = "exclamation", e.hidebutton = !1, e.signupok = !1), "registration completed successfully" == n.data.d && (e.msg.title = "Registration completed successfully", e.msg.css = "success", e.msg.icon = "check", e.hidebutton = !0, e.signupok = !0) }, function (n) { alert(n.data.d), e.hidebutton = !1, e.signupok = !1 })) } }]).controller("orderCtrl", ["$scope", "$http", "$rootScope", function (e, n, s) { e.application = s.application, e.version = s.version, e.userType = 1, e.showAlert = !1, e.sendicon = "fa fa-angle-double-right", e.sendicontitle = "Dalje", e.showUserDetails = !1, e.showErrorAlert = !1, e.showPaymentDetails = !1; var a = function () { n({ url: s.config.backend + "Orders.asmx/Init", method: "POST", data: "" }).then(function (n) { e.user = JSON.parse(n.data.d), e.user.application = e.application, e.user.version = e.version, e.user.licence = 1, e.user.licenceNumber = 1, e.user.userType = e.userType, e.calculatePrice() }, function (e) { alert(e.data.d) }) }; null == s.config ? n.get("./config/config.json").then(function (e) { s.config = e.data, a() }) : a(), e.changeUserType = function (n) { e.userType = n }, e.calculatePrice = function () { var n, a = 0; 0 == e.user.userType && (a = 550, e.user.version = "START"), 1 == e.user.userType && (a = 950, e.user.version = "STANDARD"), 2 == e.user.userType && (a = 1850, e.user.version = "PREMIUM"), e.user.licence > 1 && (a = a * e.user.licence - a * e.user.licence * (e.user.licence / 10)), e.user.licenceNumber = 1, n = e.user.licenceNumber > 1 ? a * e.user.licenceNumber - a * e.user.licenceNumber * .1 : a, e.user.price = n, e.user.priceEur = n / s.config.eur }, e.order = function (n, s) { a(), window.location.hash = "order", e.user.application = n, e.user.version = s, e.calculatePrice() }, e.setApplication = function (n) { e.user.application = n, e.calculatePrice() }, e.sendOrder = function (a) { return e.showErrorAlert = !1, "" == a.email || "" == a.firstName || "" == a.lastName || "" == a.address || "" == a.postalCode || "" == a.city || "" == a.country ? (e.showErrorAlert = !0, e.errorMessage = "All fields are required", !1) : 1 != e.userType || "" != a.companyName && "" != a.pin ? (e.sendicon = "fa fa-spinner fa-spin", e.sendicontitle = "Sending", e.isSendButtonDisabled = !0, void n({ url: s.config.backend + "Orders.asmx/SendOrder", method: "POST", data: { x: a, lang: s.config.language } }).then(function (n) { e.showAlert = !0, e.showPaymentDetails = !0, window.location.hash = "orderform" }, function (n) { e.showAlert = !1, e.showPaymentDetails = !1, e.sendicon = "fa fa-paper-plane-o", e.sendicontitle = "Send", alert(n.data.d) })) : (e.showErrorAlert = !0, e.errorMessage = "All fields are required", !1) }, e.login = function (a, r) { n({ url: s.config.backend + "Users.asmx/Login", method: "POST", data: { userName: a, password: r } }).then(function (n) { var s = JSON.parse(n.data.d); s.userName == a ? (e.user.firstName = s.firstName, e.user.lastName = s.lastName, e.user.companyName = s.companyName, e.user.address = s.address, e.user.postalCode = s.postalCode, e.user.city = s.city, e.user.country = s.country, e.user.pin = s.pin, e.user.email = s.email, e.showUserDetails = !0, e.showErrorAlert = !1) : (e.showErrorAlert = !0, e.errorMessage = "Error login") }, function (n) { e.errorLogin = !0, e.showErrorAlert = !0, e.errorMessage = "Error login", e.showUserDetails = !1 }) }, e.registration = function () { window.location.hash = "registration" }, e.gotoForm = function () { e.showUserDetails = !0 }, e.forgotPassword = function (a) { e.showErrorAlert = !1, e.showSuccessAlert = !1, null == a || "" == a ? (e.showErrorAlert = !0, e.errorMessage = "Enter E-mail") : n({ url: s.config.backend + "Users.asmx/ForgotPassword", method: "POST", data: { email: a, lang: s.config.language } }).then(function (n) { e.showSuccessAlert = !0, e.successMessage = JSON.parse(n.data.d) }, function (n) { e.showErrorAlert = !0, e.errorMessage = JSON.parse(n.data.d) }) }, e.showAppLink = !1, e.alertclass = "success", e.confirmPayPal = function (a, r) { if (e.showErrorAlert = !1, e.showSuccessAlert = !1, e.showAppLink = !1, void 0 === a || void 0 === r) return e.showErrorAlert = !0, e.errorMessage = "Enter E-mail and password", !1; n({ url: s.config.backend + "Users.asmx/ConfirmPayPal", method: "POST", data: { userName: a, password: r, lang: s.config.language } }).then(function (n) { e.showSuccessAlert = !0, e.successMessage = JSON.parse(n.data.d), "your account has been successfully activated" == e.successMessage ? (e.alertclass = "success", e.showAppLink = !0) : e.alertclass = "danger" }, function (n) { e.showErrorAlert = !0, e.errorMessage = JSON.parse(n.data.d) }) } }]).controller("contactCtrl", ["$scope", "$http", "$rootScope", function (e, n, s) { e.showAlert = !1, e.sendicon = "fa fa-paper-plane-o", e.sendicontitle = "Send", e.d = { name: "", email: "", message: "" }, e.send = function (a) { null == s.config.backend && s.getConfig(), e.isSendButtonDisabled = !0, e.sendicon = "fa fa-spinner fa-spin", e.sendicontitle = "Sending", n({ url: s.config.backend + "Mail.asmx/Send", method: "POST", data: { name: a.name, email: a.email, messageSubject: "nutrition Plan - Inquiry", message: a.message, lang: s.config.language } }).then(function (n) { e.showAlert = !0, e.sendicon = "fa fa-paper-plane-o", e.sendicontitle = "Send", window.location.hash = "contact" }, function (n) { e.showAlert = !1, e.sendicon = "fa fa-paper-plane-o", e.sendicontitle = "Send", alert(n.data.d) }) } }]);